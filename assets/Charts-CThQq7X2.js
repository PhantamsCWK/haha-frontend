import{c as m,u as p,b as u,j as e}from"./index-BN32oiS2.js";import{M as h}from"./index-CYJ4HqCl.js";import{u as f}from"./useMutation-BKtzrgFW.js";import{a as j}from"./index-oTxUbyLe.js";import"./iconBase-AcLIelEe.js";const g=()=>{const{cart:t,setCart:r}=m(),{logout:n,token:c}=p(),o=u(),i=s=>{r(t.filter(a=>a.id!==s))},d=t.reduce((s,a)=>s+a.price*a.qty,0),l=f({mutationFn:async s=>await j.post("/orders",{items:s}),onSuccess:()=>{alert("Order placed successfully!"),r([])},onError:s=>{s.response?.status===401?(alert("Session expired, please login again."),n(),o("/login")):alert("Failed to place order: "+s.message)}}),x=()=>{const s=t.map(a=>({product_id:a.id,quantity:a.qty}));l.mutate(s)};return e.jsxs("div",{className:"w-full shadow-md rounded-xl p-6 mt-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Your Cart"}),t.length===0?e.jsx("p",{className:"text-gray-500",children:"Your cart is empty."}):e.jsx("div",{className:"flex flex-col gap-4",children:t.map(s=>e.jsxs("div",{className:"flex justify-between items-center border-b pb-2",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:s.name}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Rp.",s.price.toLocaleString()," Ã— ",s.qty]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"font-bold",children:["Rp.",(s.price*s.qty).toLocaleString()]}),e.jsx("button",{className:"text-red-500",onClick:()=>i(s.id),children:e.jsx(h,{size:20})})]})]},s.id))}),t.length>0&&e.jsxs("div",{className:"mt-6 flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-bold",children:"Total:"}),e.jsxs("span",{className:"text-xl font-bold text-primary",children:["Rp.",d.toLocaleString()]})]}),t.length>0&&e.jsx("button",{className:"btn btn-primary w-full mt-4",onClick:x,disabled:l.isLoading||!c,children:c?l.isLoading?"Processing...":"Checkout":"Need Login to Checkout"})]})},C=()=>e.jsx("section",{className:"pt-[4px] mx-1 lg:mx-[46px]",children:e.jsxs("div",{className:"flex flex-col justify-center items-center col-span-5 w-full xl:col-span-3 xl:mr-[64px] xl:max-w-[5000rem]",children:[e.jsx("div",{className:"card h-20 w-full flex flex-row items-center shadow-2xl",children:e.jsx("h1",{className:"text-3xl p-5",children:"Cart"})}),e.jsx(g,{})]})});export{C as default};
