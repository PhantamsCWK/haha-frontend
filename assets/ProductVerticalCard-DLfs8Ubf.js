import{a as m,j as e,r as h,c as j}from"./index-CZFq8Sd1.js";import{a as g,P as f}from"./index-CgzBaONa.js";import{M as b,a as y}from"./index-DnRb98d8.js";import{a as u,p as N}from"./index-IO3GkPlo.js";import{u as v,P as C}from"./PropagateLoader-DxoLwLM4.js";import{u as x}from"./useMutation-OakkHmAg.js";import{u as P}from"./index.esm-CrXVM86y.js";function S({product:s}){const d=m(),{register:i,handleSubmit:r}=P({defaultValues:{name:s?.name||"",price:s?.price||"",description:s?.description||""}}),c=x({mutationFn:async a=>await u.put(`/products/${s.id}`,a),onSuccess:()=>{d.invalidateQueries(["products"]),document.getElementById(`edit_product_modal${s.id}`).close()}}),t=a=>{c.mutate(a)};return e.jsx("dialog",{id:`edit_product_modal${s.id}`,className:"modal",children:e.jsxs("div",{className:"modal-box",children:[e.jsx("h3",{className:"font-bold text-lg",children:"Edit Product"}),e.jsxs("form",{onSubmit:r(t),className:"flex flex-col gap-3",children:[e.jsx("input",{type:"text",...i("name",{required:!0}),placeholder:"Product Name",className:"input input-bordered w-full"}),e.jsx("input",{type:"number",...i("price",{required:!0}),placeholder:"Price",className:"input input-bordered w-full"}),e.jsx("input",{...i("description"),placeholder:"Description",defaultValue:s?.description,className:"textarea textarea-bordered w-full"}),e.jsxs("div",{className:"modal-action",children:[e.jsx("button",{type:"submit",className:"btn btn-primary",children:"Save"}),e.jsx("button",{type:"button",className:"btn",onClick:()=>document.getElementById(`edit_product_modal${s.id}`).close(),children:"Cancel"})]})]})]})})}const z=({isAdmin:s=!1})=>{const d=m(),{data:i,isPending:r,isError:c,error:t}=v({queryKey:["products"],queryFn:async()=>await N.get("/products")}),a=x({mutationFn:async n=>await u.delete(`/products/${n}`),onSuccess:()=>{d.invalidateQueries(["products"])}});return c?e.jsx("div",{className:"flex flex-col justify-center items-center gap-5 py-3 h-[75vh]",children:e.jsx("h1",{className:"text-3xl text-[#570DF8] capitalize",children:t.data.message})}):r?e.jsx("div",{className:"flex flex-col justify-start items-center gap-5 py-3 h-96",children:e.jsx(C,{className:"mt-36",size:30,color:"#570DF8"})}):e.jsx(e.Fragment,{children:e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-2 p-2 min-h-full min-w-full",children:i.data.data.map((n,o)=>e.jsx("div",{className:"aspect-square",children:e.jsx(w,{product:n,isAdmin:s,deleteProduct:a})},o))})})},w=({product:s,isAdmin:d,deleteProduct:i})=>{const[r,c]=h.useState(!1),{cart:t,setCart:a}=j(),n=o=>{const p=t.find(l=>l.id===o.id);a(p?t.map(l=>l.id===o.id?{...l,qty:l.qty+1}:l):[...t,{...o,qty:1}]),c(!r)};return e.jsxs("article",{className:"flex flex-row w-full",children:[e.jsxs("div",{className:"card bg-base-100 h-max-[500px] shadow-sm",children:[e.jsx("figure",{children:e.jsx("img",{src:s.photo,alt:s.name})}),e.jsxs("div",{className:"card-body",children:[e.jsx("h2",{className:"card-title",children:s.name}),e.jsx("p",{children:s.description}),e.jsxs("div",{className:"card-actions justify-end",children:[e.jsxs("div",{className:"badge badge-info",children:["Rp.",s.price]}),e.jsxs("div",{className:"badge badge-dash",children:["Stock: ",s.stock]}),d?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"badge badge-error",onClick:()=>i.mutate(s.id),children:e.jsx(b,{size:20})}),e.jsx("div",{className:"badge badge-warning",onClick:()=>document.getElementById(`edit_product_modal${s.id}`).showModal(),children:e.jsx(y,{size:20})})]}):e.jsx("div",{className:"badge badge-primary cursor-pointer",onClick:()=>n(s),children:r?e.jsx(g,{}):e.jsx(f,{})})]})]})]}),e.jsx(S,{product:s})]})};export{z as P};
