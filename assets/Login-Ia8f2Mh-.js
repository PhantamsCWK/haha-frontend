import{r as c,j as e,u as f,a as b,b as y,L as N}from"./index-TzHnXw__.js";import{u as v}from"./index.esm-26NaBcNJ.js";import{d as C,e as F}from"./index-DZBanOBh.js";import{p as S}from"./index-oTxUbyLe.js";import{u as B}from"./useMutation-CwJCuSbD.js";import{B as E}from"./BeatLoader-Bw5_FX2x.js";import{G as p}from"./iconBase-DNB978J7.js";function D(t){return p({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M12 2C6.486 2 2 6.486 2 12c.001 5.515 4.487 10.001 10 10.001 5.514 0 10-4.486 10.001-10.001 0-5.514-4.486-10-10.001-10zm0 18.001c-4.41 0-7.999-3.589-8-8.001 0-4.411 3.589-8 8-8 4.412 0 8.001 3.589 8.001 8-.001 4.412-3.59 8.001-8.001 8.001z"},child:[]}]})(t)}function L(t){return p({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"m16.192 6.344-4.243 4.242-4.242-4.242-1.414 1.414L10.535 12l-4.242 4.242 1.414 1.414 4.242-4.242 4.243 4.242 1.414-1.414L13.364 12l4.242-4.242z"},child:[]}]})(t)}const z=({message:t,type:a="error",onClose:o})=>{const[n,i]=c.useState(!0),l=()=>{i(!1),o()};return e.jsx(e.Fragment,{children:n&&e.jsxs("div",{className:`alert alert-${a} drop-shadow-2xl shadow-lg`,children:[e.jsx(D,{}),e.jsx("span",{className:"text-sm",children:t}),e.jsx("button",{className:"btn btn-sm btn-error",children:e.jsx(L,{onClick:l,size:25,className:" hover:cursor-pointer"})})]})})},k=({setAlertMessage:t})=>{const{login:a}=f(),o=b(),n=y(),{register:i,handleSubmit:l,reset:x,setError:m,clearErrors:d,formState:{errors:r}}=v({defaultValues:{email:"",password:""}}),{mutate:h,isPending:j}=B({mutationFn:async s=>await S.post("/login",s),onSuccess:({data:s})=>{a({token:s.token,user:{...s.user,role:s.user.role[0]}}),o.invalidateQueries(["users"]),n("/"),x()},onError:s=>{if(s.status===422){m("email",{type:"manual",message:"email or password wrong"},{shouldFocus:!0}),m("password",{type:"manual",message:"email or password wrong"},{});return}else s.status===429&&(m("root",{type:"manual",message:s.data.message}),t(s.data.message))}}),[u,g]=c.useState(!1),w=async s=>{h({email:s.email,password:s.password})};return e.jsx(e.Fragment,{children:e.jsxs("form",{className:"join join-vertical gap-4",onSubmit:l(w),children:[e.jsx("div",{className:"join-item w-full flex justify-center items-center",children:e.jsx("h1",{className:" text-purple-400  text-3xl",children:"CucuCoffee"})}),e.jsx("div",{className:"join-item join join-vertical",children:e.jsx("input",{type:"text",placeholder:"Email",...i("email"),className:`input input-primary input-bordered bg-white ${r.email||r.root?" border-red-500 text-red-500 focus:outline-red-500":"input-primary text-[#570DF8]"} w-full text-sm font-medium`,onChange:()=>d(["email"]),required:!0})}),e.jsxs("div",{className:"join-item join",children:[e.jsx("input",{type:u?"text":"password",placeholder:"Password",...i("password"),className:`join-item input input-bordered bg-white ${r.password||r.root?" border-red-500 text-red-500 focus:outline-red-600":"input-primary text-[#570DF8]"} text-sm font-medium`,onChange:()=>d(["password"]),required:!0}),e.jsx("span",{onClick:()=>g(s=>!s),className:`join-item border flex justify-center items-center  ${r.password||r.root?"border-red-500":"border-[#570DF8]"} bg-white hover:cursor-pointer w-12`,children:u?e.jsx(C,{size:20,color:"#570DF8"}):e.jsx(F,{size:20,color:"#570DF8"})})]}),r.email&&e.jsxs("span",{className:"italic text-red-500 text-sm",children:["*",r.email.message]}),e.jsxs("button",{type:"submit",className:"btn join-item btn-outline btn-primary",children:[" ",j?e.jsx(E,{}):"Submit"]}),e.jsxs("span",{className:" text-gray-700 join-item",children:["Doesnt have anÂ ",e.jsx(N,{to:"/register",className:"text-[#570DF8] font-semibold",children:"account ?"})]})]})})},I=()=>{const[t,a]=c.useState(""),o=()=>{a("")};return e.jsxs("div",{className:"flex flex-col justify-center items-center gap-5 max-w-6xl",children:[t&&e.jsx(z,{message:t,type:"error",onClose:o}),e.jsx("div",{className:"px-7 py-10 bg-white bg-opacity-40 drop-shadow-2xl shadow-2xl rounded-2xl max-w-xs",children:e.jsx(k,{setAlertMessage:a})})]})};export{I as default};
